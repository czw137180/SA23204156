---
title: "Homework-2023.11.20"
author: "By SA23204156 程张伟"
date: "2023-11-23"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Homework-2023.11.20}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
   
## Overview  
   
The content is the homework of the course.

```{r,eval=FALSE}
library(Rcpp)
library(microbenchmark)
```

## Question  
   
2.1.3  Exercise 4
Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?
   
## Answer    
   
将列表转换成向量可以进行向量方面的处理;as.vector函数是将矩阵转换成向量,元素是数,但列表里面的元素更复杂且长度不一定一致.   
   
    
## Question  
   
2.3.1 Exercise 1   
What does dim() return when applied to a vector?
   
## Answer  
    
NULL    
    
    
## Question  
   
2.3.1 Exercise 2   
If is.matrix(x) is TRUE, what will is.array(x) return?
   
## Answer    
    
TRUE   
   
## Question  
   
2.4.5 Exercise 2   
What does as.matrix() do when applied to a data frame with
columns of different types?
   
## Answer    
   
所有的列都会转换成同一种数据类型.   
   
## Question  
   
2.4.5 Exercise 3   
Can you have a data frame with 0 rows? What about 0
columns?

   
## Answer   
   
## 0行   
```{r,eval=FALSE}
d <- data.frame(x = c(1), y = c(1), z = c(1))
d <- d[-1,]
d
```
   

## 0列   
```{r,eval=FALSE}
d <- data.frame(x = c(1,2,3))
d <- d[,-1]
d
```
   
## Question  
   
11.1.2 Exercise 2   
Can you have a data frame with 0 rows? What about 0
columns?

   
## Answer  

```{r,eval=FALSE}
scale01 <- function(x) {
  rng <- range(x, na.rm = TRUE)
  (x - rng[1]) / (rng[2] - rng[1])
}
```
   
应用到每一列
```{r,eval=FALSE}
d1 <- data.frame(x = c(1,2,3), y = c(2,3,6))   
lapply(d1, scale01)
```
   
应用到每一数值的列   
```{r,eval=FALSE}
d2 <- data.frame(x = c(1,2,3), y = c(2,3,6), z = c("a", "b", "c"))
lapply(d2[,which(unlist(lapply(d2, is.numeric)))], scale01)   #对每一列先应用is.numeric函数,再对合适的列用scale01函数
```
   

    
## Question  
   
11.2.5 Exercise 1   
Can you have a data frame with 0 rows? What about 0
columns?

   
## Answer  
  
应用到每一列
```{r,eval=FALSE}
d1 <- data.frame(x = c(1,2,3), y = c(2,3,6))   
vapply(d1, sd, c(sd = 0))
```
   
应用到每一数值的列   
```{r,eval=FALSE}
d2 <- data.frame(x = c(1,2,3), y = c(2,3,6), z = c("a", "b", "c"))
vapply(d2[,which(unlist(vapply(d2, is.numeric, c(sd=0)))==1)], sd, c(sd=0))   #对每一列先应用is.numeric函数,再对合适的列用scale01函数
```


## Question  
   
对exercise 9.8分别编写r函数和rcpp函数比较速度   


## Answer   
   
r function
```{r,eval=FALSE}
fr <- function(a, b, n, N){
  X <- matrix(0, N, 2)
  X[1, ] <- c(1, 1/2)
  for (i in 2:N) {
    y <- X[i-1, 2]
    X[i,1] <- rbinom(1, n, y)   #更新一个变量
    x <- X[i,1]
    X[i,2] <- rbeta(1, a, b)    #更新另一个变量
  }
  return(X)
}
```

```{r,eval=FALSE}
cppFunction('NumericMatrix fc(float a, float b, int n, int N){;
            NumericMatrix X(N,2);
            X[1,1] = 1;
            X[1,2] = 1/2;
            for(int i = 2; i <= N; i++){
              float y = X[i-1,2];
              NumericVector x = rbinom(1, n, y); 
              X[i,1] = x[1];
              NumericVector z = rbeta(1, a, b);
              X[i,2] = z[1];
            }
            return(X);
}')
```

```{r,eval=FALSE}
ts <- microbenchmark(fR = fr(2, 2, 10, 1000), fC = fc(2, 2, 10, 1000))
summary(ts)[,c(1,3,5,6)]
```
   
从结果可以看出用cpp的时间大大减少.    
   
